{%- liquid
  assign show_date = true
  assign show_comments = false
  assign show_tags = true
  assign show_author = true
  assign aspect_ratio = 2
  assign show_button = true

  assign animation_order = animation_order | plus: 1
  if index > eager_images_limit
    assign loading = 'lazy'
  endif
-%}

{%- capture tags -%}
  {%- if article.tags.size > 0 and show_tags -%}
    <div class="article__tags">
      {%- for tag in article.tags limit: 3 -%}
        <a href="{{ blog.url }}/tagged/{{ tag | handle }}" title="{{ blog.title }} tagged {{ tag | escape }}" class="article__tag">{{ tag }}</a>
      {%- endfor -%}
    </div>
  {%- endif -%}
{%- endcapture -%}

<article class="article grid-item" onclick="location.href='{{ article.url }}'">
  <div class="article__link_image_text_wrapper">
    {%- if article.image -%}
      <div class="article__image__outer">
        <div class="article__image">
          <a class="article__image-link" href="{{ article.url }}" aria-label="{{ article.title | strip_html | escape }}">
            {%- capture sizes -%}
              (min-width: 990px) calc((100vw - 100px) / 3), (min-width: 750px) calc((100vw - 60px) / 3), calc(100vw - 32px)
            {%- endcapture -%}
            {%- capture attributes -%}
              data-aos="img-in"
              data-aos-anchor="{{ animation_anchor }}"
              data-aos-order="{{ animation_order }}"
              data-aos-duration="{{ animation_duration }}"
              data-aos-easing="ease-out-quart"
            {%- endcapture -%}
            {%- render 'image' image: article.image, widths: '250, 280, 360, 480, 560, 640, 720, 840, 960, 1280, 1440, 1600, 1840, 2100, 2400', sizes: sizes, aspect_ratio: aspect_ratio, loading: loading, attributes: attributes, show_backfill: true -%}
          </a>
          {{ tags }}
        </div>
      </div>
    {%- else -%}
      {{ tags }}
    {%- endif -%}
    <div class="article__text-wrapper"
      data-aos="hero"
      data-aos-anchor="{{ animation_anchor }}"
      data-aos-order="{{ animation_order }}"
      data-aos-duration="{{ animation_duration }}">
      <p class="article__meta">
        {%- if show_date -%}
          {%- assign published_at = article.published_at | date: format: 'full_date' -%}
          <time datetime="{{ published_at }}">{{ published_at }}</time> 
        {%- endif -%}
      </p>
      <h2 class="article__title {{ title_size_class }}">
        <a href="{{ article.url }}" title="{{ article.title | strip_html | escape }}">
          {{ article.title }}
        </a>
      </h2>
      {%- if show_date or show_author or show_comments -%}
        <p class="article__meta">
          {%- if show_comments and article.comments_count > 0 -%}
            <span class="comment-count">{{ 'blogs.comments.comments_with_count' | t: count: article.comments_count }}</span>
          {%- endif -%}
        </p>
      {%- endif -%}
      <p class="article__excerpt">{{ article.excerpt_or_content | strip_html | truncatewords: 30 }}</p>
      {% if article.metafields.custom.author_name.value != blank %}
        <p class="article__meta__author cstm__metafieldtxt">Written By: {{ article.metafields.custom.author_name.value }}</p>
      {% endif %}
      {% if article.metafields.custom.reviewed_by_author.value != blank %}
        <p class="article__meta__reviewer cstm__metafieldtxt">Reviewed By: {{ article.metafields.custom.reviewed_by_author.value }}</p>
      {% endif %}
      {%- if show_button -%}
        <div class="article__link">
          <a href="{{ article.url }}" class="btn btn--text" aria-label="{{ 'blogs.article.read_more' | t }}">
            <span>{{ 'blogs.article.read_more' | t }} - {{ article.metafields.custom.minute_read_time }} min</span>
          </a>
        </div>
      {%- endif -%}
    </div>
  </div>
</article>