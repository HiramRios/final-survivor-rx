{%- liquid
  assign aspect_ratio = 1 | divided_by: section.settings.aspect_ratio
   -%}
{%- liquid
                    assign counter = 0
                    assign article_limit = 3
                    assign recent_articles = ''
                  -%}

                  {%- for recent_article in blog.articles -%}
                    {%- if recent_article.handle == article.handle -%}
                      {%- continue -%}
                    {%- endif -%}
                {%- capture tags -%}
                          <div class="article__tags">
                              {%- for tag in recent_article.tags limit: 3 -%}
                                <a href="{{ recent_article.url }}/tagged/{{ tag | handle }}" title="{{ recent_article.title }} tagged {{ tag | escape }}" class="article__tag">{{ tag }}</a>
                              {%- endfor -%}
                            </div>
                         {%- endcapture -%}
                    {%- capture recent_markup -%}
                      <article class="article">
                        <div class="article__image_wrapper_image">
                        {%- if recent_article.image != blank -%}
                          <div class="article__image__outer">
                           
                            <div class="article__image">
                              <a class="article__image-link" href="{{ recent_article.url }}" aria-label="{{ recent_article.title | strip_html | escape }}">
                                {%- render 'image'  aspect_ratio: aspect_ratio,image: recent_article.image, widths: '320, 480, 560, 640, 780, 960, 1280, 1440, 1960', sizes: '(min-width: 750px) 320px, calc(100vw - 32px)' -%}
                              </a>
                              {{ tags }}
                            </div>
                          </div>
                        {%- endif -%}

                        <div class="article__text-wrapper">
                          {%- if section.settings.show_date or section.settings.show_author -%}
                            <p class="article__meta">
                              {%- if section.settings.show_date -%}
                                {%- assign published_at = recent_article.published_at | date: format: 'full_date' -%}
                                <time datetime="{{ published_at }}">{{ published_at }}</time>
                              {%- elsif section.settings.show_author -%}
                                <span class="article__meta__author">{{ 'blogs.article.by_author' | t: author: article.author }} </span>
                              
                              {%- endif -%}
                            </p>
                          {%- endif -%}
                          <h2 class="article__title heading-size-4">
                            <a href="{{ recent_article.url }}" title="{{ recent_article.title | strip_html | escape }}">
                              {{ recent_article.title }}
                            </a>
                          </h2>
                     <p class="article__excerpt">{{ recent_article.excerpt_or_content | strip_html | truncatewords: 30 }}</p>
                        </div>
                          
                        </div>
                       <div class="article__link">
                <a href="{{ recent_article.url }}" class="btn btn--text" aria-label="{{ 'blogs.article.read_more' | t }}">
                  <span>Read More</span>
                </a>
              </div>
                      </article>
                    {%- endcapture -%}

                    {%- assign recent_articles = recent_articles | append: recent_markup -%}
                    {%- assign counter = counter | plus: 1 -%}

                    {%- if counter == article_limit -%}
                      {%- break -%}
                    {%- endif -%}
                  {%- endfor -%}

                  <div class="widget custom_recent_blogs_wrapper {{ section.settings.width }}" {{ block.shopify_attributes }}>
                    {%- if recent_articles != '' -%}
                      {%- if section.settings.title != blank -%}
                        <h3 class="widget__title" style="font-size:{{ section.settings.font_size }}px;">{{ section.settings.title }}</h3>
                      {%- endif -%}
                      {% if section.settings.sub_heading != blank %}
                     <span class="sub-cstm" style="font-size:{{ section.settings.text_size }}px;"> {{ section.settings.sub_heading }}</span>
                        {% endif %}
                      <div class="widget__recent">
                        {{ recent_articles }}
                      </div>
                    {%- endif -%}
                  </div>

{% schema %}
  {
    "name": "Recent Blogs",
    "settings": [
      {
        "type": "checkbox",
        "id": "show_date",
        "label": "Show date",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_author",
        "label": "Show author",
        "default": true
      },
      {
        "type": "text",
        "id": "title",
        "label": "Heading"
       
      },
       {
        "type": "range",
        "id": "font_size",
        "min": 20,
        "max": 50,
        "step": 5,
        "unit": "px",
        "label": "Heading Size",
        "default": 20
      },
       {
        "type": "richtext",
        "id": "sub_heading",
        "label": "Sub Heading"
       
      },
      {
        "type": "range",
        "id": "text_size",
        "min": 18,
        "max": 50,
        "step": 2,
        "unit": "px",
        "label": "Sub Heading Size",
        "default": 20
      },
       {
        "type": "range",
        "id": "aspect_ratio",
        "min": 0.5,
        "max": 1.5,
        "step": 0.1,
        "unit": ":1",
        "label": "Article image aspect ratio",
        "info": "Wide to tall",
        "default": 1
      },
      {
        "type": "select",
        "id": "width",
        "label": "Width",
        "default": "wrapper--full-padded",
        "options": [
          {"value": "wrapper--full", "label": "Full width"},
          {"value": "wrapper--full-padded", "label": "Full width padded"},
          {"value": "wrapper", "label": "Normal"}
        ]
      }
    ],
     "presets": [
      {
        "name": "Recent Blogs"
       
      }
    ]
  }
{% endschema %}